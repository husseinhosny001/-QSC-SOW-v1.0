بروتوكول استعادة الحالة الكمومية التجريبي الدقيق
 (Quantum State Tomography)

رقم الوثيقة: QSC-PROTO-001
الإصدار: 1.0
المعيار المرجعي: مُستمد من J.B. Altepeter et al., "Quantum State Tomography" (2004)، مع تعديلات للدوائر المتكاملة الضوئية.

---

1. الهدف

استخراج مصفوفة الكثافة التجريبية (ρ_exp) للإشارة المولَّدة بواسطة الرقاقة (مع التركيز على حالة بِلّ المتشابكة |Ψ⁻⟩) بدقة إحصائية تكفي لحساب إخلاص التشابك (F > 0.99) مع شك معياري (ΔF < 0.005).

2. المتطلبات الأساسية (قبل البدء)

2.1 المعدات

العنصر المواصفات الغرض/التأثير على الدقة
الرقاقة تحت الاختبار (DUT) مثبتة على حاملة، موصولة بمصادر تغذية وتبريد (إن وجد). استقرار حراري < 0.1°K خلال الاختبار.
مصدر ضخ ليزري طول موجة 775 نانومتر (لـ SPDC)، استقرار طاقة < 1%. يحدد ثبات معدل توليد الأزواج.
منظومة الكشف (SNSPD) كاشفان، كفاءة كشف > 80%، توقيت ميت (Dead Time) < 100 نانوثانية. تؤثر مباشرة على دقة قياس الاحتماليات.
عداد التزامن (Time-Correlator) دقة زمنية (Time Bin) ≤ 10 بيكوثانية، نافذة تزامن مسيطر عليها. لتمييز التزامنات الحقيقية عن العشوائية.
وحدات تحكم في الاستقطاب والطور مثبتة على ألياف، قابلة للبرمجة، دقة ضبط < 0.5 درجة. لتنفيذ إعدادات القياس المختلفة.
برمجية التحكم والجمع مبرمجة للتحكم بالتسلسل وجمع البيانات تلقائياً. لتقليل الخطأ البشري وضمان الاتساق.

2.2 المعايرة الأولية الإلزامية

1. معايرة الخلفية: قفل مصدر الضم، قياس معدل العد الخلفي (Dark Count Rate) لكل كاشف لمدة 10 دقائق. يجب أن يكون < 100 عددة/ثانية.
2. معايرة زمن التزامن: استخدام إشارة ليزرية ضعيفة لتحديد التأخير الزمني الدقيق بين قناتي الكشف وضبط نافذة التزامن المثلى (عادة عرض 2 × FWHM لذروة التزامن).
3. معايرة المحللات: ضبط المحللين (على ألياف الدخل) للحصول على نسبة إطفاء (Extinction Ratio) > 30 ديسيبل في قنوات |H⟩ و |V⟩.

---

3. إجراء القياسات (Workflow)

3.1 التسلسل العام

1. تشغيل النظام: ابدأ بالتبريد (إذا لزم الأمر)، التشغيل الكهربائي، ثم مصدر الضم.
2. التحقق من الاستقرار: اترك النظام يعمل لمدة 30 دقيقة مع مراقبة معدل العد. يجب أن يكون الانحراف المعياري < 2% قبل البدء.
3. تنفيذ التسلسل البرمجي الذي يضبط إعدادات التحليل تلقائياً وفق الجدول أدناه، ويسجل البيانات.

3.2 جدول إعدادات القياس الستة عشر (16)

للحصول على جميع عناصر ρ (مصفوفة 4×4)، يجب قياس الاحتماليات المشتركة تحت المشغلين القياسيين لكل من أليس وبوب التالية:

الرقم إعداد أليس (قناة 1) إعداد بوب (قناة 2) القاعدة المقاسة المتجه المُحلل (على كرة بلوخ)
1 I (هوية) I (هوية) II (1,0,0) ⊗ (1,0,0)
2 Z I ZI (0,0,1) ⊗ (1,0,0)
3 I Z IZ (1,0,0) ⊗ (0,0,1)
4 Z Z ZZ (0,0,1) ⊗ (0,0,1)
5 X I XI (1,0,0) بعد دوران π/2 حول Y
6 Y I YI (1,0,0) بعد دوران π/2 حول X
7 X Z XZ ...
8 Y Z YZ ...
9 I X IX ...
10 I Y IY ...
11 Z X ZX ...
12 Z Y ZY ...
13 X X XX (1,0,0) ⊗ (1,0,0) بعد دوران π/2 حول Y لكليهما
14 X Y XY ...
15 Y X YX ...
16 Y Y YY (1,0,0) ⊗ (1,0,0) بعد دوران π/2 حول X لكليهما

3.3 بروتوكول جمع البيانات لكل إعداد

1. ضبط الجهاز: استخدم الدارة المتكاملة (المراحل الكهروضوئية أو الحرارية) لتحقيق إدارة الاستقطاب المطلوبة في الجدول أعلاه.
2. التصفية الزمنية: اجمع البيانات لمدة T = 10 ثوانٍ لكل إعداد (أو حتى يصل عدد التزامنات N_coinc > 50,000).
3. تسجيل البيانات الخام: سجل في ملف (مثل CSV):
   · Timestamp, Setting_ID, N_HH, N_HV, N_VH, N_VV, Total_Time
   · حيث N_AB هو عدد الأحداث التي كُشف فيها فوتون أليس في حالة A وبوب في B.
4. مراقبة الخلفية: كل 10 إعدادات، أعد قياس معدل الخلفية لمدة 10 ثوانٍ.

---

4. معالجة البيانات واستخراج ρ_exp

4.1 التصحيح الأولي للبيانات الخام

1. طرح الخلفية: لكل إعداد i:
   N_{AB}^{corr}(i) = N_{AB}^{raw}(i) - (R_{dark,A} \cdot R_{dark,B} \cdot T(i)^2)
   حيث R_dark هو معدل العد الخلفي للكاشف.
2. تصحيح الكفاءة: (إذا اختلفت كفاءة الكواشف بشكل كبير):
   P_{AB}^{exp}(i) = \frac{N_{AB}^{corr}(i)}{\eta_A \eta_B \cdot N_{pump} \cdot T(i)}
   حيث η هي الكفاءة الكلية لكل مسار.

4.2 إعادة بناء مصفوفة الكثافة (الخطية)

احسب الاحتمالات المُصححة P_AB(i) لكل إعداد من الـ 16. مصفوفة الكثافة ρ (بتمثيل منتج تينسور لمصفوفات باولي σ_i ⊗ σ_j) تُعطى بالمعكوس الخطي:

\rho = \frac{1}{4} \sum_{i,j=0}^{3} \langle \sigma_i \otimes \sigma_j \rangle \, \sigma_i \otimes \sigma_j

حيث المتوسطات ⟨σ_i ⊗ σ_j⟩ تُحسب مباشرة من الاحتمالات المقاسة. على سبيل المثال:

\langle Z \otimes I \rangle = P_{HH} + P_{HV} - P_{VH} - P_{VV}

(مع تطابق المؤشرات مع الإعدادات في الجدول).

4.3 تنقيح مصفوفة الكثافة (باستخدام التعظيم الاحتمالي - MLE)

لضمان أن ρ هي مصفوفة كثافة فيزيائية (موجبة-شبه محددة، أثرها 1)، نطبق خوارزمية MLE:

1. التابع الهدف (Likelihood):
   \mathcal{L}(\rho) = \prod_{i, A, B} [\text{Tr}(M_{AB}^{(i)} \rho)]^{N_{AB}(i)}
   حيث M_{AB}^{(i)} هو مشغل القياس للإعداد i والناتج AB.
2. الخوارزمية التكرارية: استخدم خوارزمية RρR التكرارية:
   \rho_{k+1} = \mathcal{N} \left[ R(\rho_k) \, \rho_k \, R(\rho_k) \right]
   R(\rho) = \sum_{i, A, B} \frac{N_{AB}(i)}{\text{Tr}(M_{AB}^{(i)} \rho)} M_{AB}^{(i)}
   حتى التقارب (التغير في ρ < 10⁻⁶).

ملاحظة: يتم توفير كود تنفيذ هذه الخوارزمية في /02_SIMULATION_CODE/utilities/tomography_mle.py.

---

5. التحقق من النتائج وحساب عدم اليقين

5.1 حساب الإخلاص وعدم اليقين

1. الإخلاص: F = ⟨Ψ⁻|ρ_exp|Ψ⁻⟩.
2. عدم اليقين (الشك المعياري): استخدم طريقة إعادة العينة الإحصائية (Bootstrap):
   · أنشئ 1000 مجموعة بيانات "وهمية" بإعادة أخذ العينات من البيانات الأصلية مع السماح بالتكرار.
   · أعد بناء ρ لكل مجموعة.
   · احسب F لكل منها.
   · الشك المعياري ΔF = الانحراف المعياري لتوزيع قيم F الـ 1000.

5.2 مؤشرات الجودة

· نقاء (Purity): Tr(ρ²). قريب من 1 للحالات النقية.
· التشابك (Concurrence): C(ρ). يجب أن يكون > 0.9 للإخلاص المستهدف.
· تحقق من الإيجابية: جميع قيم ρ الذاتية يجب أن تكون ≥ 0.

6. تسجيل النتائج والأرشفة

1. ملف البيانات: أرشف جميع البيانات الخام والمصححة في /04_CHARACTERIZATION_DATA/raw/[DATE]_QST/.
2. تقرير القياس: أنشئ مستندًا ملخصًا في /04_CHARACTERIZATION_DATA/reports/ يتضمن:
   · مصفوفة ρ_exp (قيم ذاتية ومتجهات ذاتية).
   · قيمة F و ΔF.
   · مخطط لكرة بلوخ للحالة المُستعادة.
   · أي انحرافات ملحوظة أثناء القياس.

---

الملحق أ: قائمة السلامة والتشغيل

· ارتد نظارات الحماية دائمًا عند تشغيل الليزر.
· تأكد من التأريض لجميع المعدات الإلكترونية الحساسة.
· لا تفصل طاقة التبريد فجأة للكواشف فائقة التوصيل (SNSPD).
· حافظ على نظافة نهايات الألياف الضوئية.

الملحق ب: استكشاف الأخطاء الشائعة

المشكلة السبب المحتمل الحل
نقاء Tr(ρ²) < 0.95 ضوضاء خلفية عالية أو ضبط خاطئ للمحللات أعد معايرة نسبة الإطفاء (Extinction Ratio)، تحقق من إحصاءات العد.
إخلاص F منخفض مع C مرتفع فقد غير متماثل في المسارات أو كفاءة كشف غير متساوية قم بمعايرة تعويض الخسائر (Loss-Tuning) في الدارة المتكاملة.
قيم ذاتية سلبية صغيرة في ρ أخطاء إحصائية (قلة عدد العدود) زد زمن التجمع T لكل إعداد.

---

الخطوة التالية: استخدم برنامج fidelity_calculator.py و tomography_mle.py الموجودين في المستودع لمعالجة بياناتك التجريبية الأولى. هل تود أن ننتقل إلى مراجعة وتنقيح كود خوارزمية MLE الآن؟
